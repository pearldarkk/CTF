# Then x2 â‰¡ a (mod n) is solvable if and only if:
# The Legendre symbol ( a p ) = 1  ({\tfrac {a}{p}})=1} ({\tfrac {a}{p}} =1 } for all odd prime divisors p of n.
import gmpy2

N = 23981306327188221819291352455300124608114670714977979223022816906368788909398653961976023086718129607035805397846230124785550919468973090809881210560931396002918119995710297723411794214888622784232065592366390586879306041418300835178522354945438521139847806375923379136235993890801176301812907708937658277646761892297209069757559519399120988948212988924583632878840216559421398253025960456164998680766732013248599742397199862820924441357624187811402515396393385081892966284318521068948266144251848088067639941653475035145362236917008153460707675427945577597137822575880268720238301307972813226576071488632898694390629
e = 0x10001
invert2 = pow(gmpy2.invert(2, N), e, N)

with open('flagencode.txt', 'r') as f:
    l = f.read().split("\n")

byte = ""
flag = ""
for c in l:
    if len(c) > 2:
        c = int(c[2:-1], 16)
        if gmpy2.jacobi(c * invert2, N) == -1:
            byte = "1" + byte
        else:
            byte = "0" + byte

        if len(byte) == 8:
            flag = chr(int(byte, 2)) + flag
            byte = ""

flag = chr(int(byte, 2)) + flag
print(flag)